# 2.  Explore Data
## Qualitative vs Quantitative
1. Qualitative data is descriptive information (it describes something) 
- Your friends' favorite holiday destination
- The most common given names in your town
- How people describe the smell of a new perfume

Data Exploration is about describing the data by means of statistical and visualization techniques. We explore data in order to bring important aspects of that data into focus for further analysis.
2. Quantitative data is numerical information (numbers)
- Height (Continuous)
- Weight (Continuous)

- Petals on a flower (Discrete)
- Customers in a shop (Discrete)

![](https://i.imgur.com/Bfs5HJH.png)

Simply: Discrete data is counted, Continuous data is measured.

## Discrete and Continuous Data
Data can be Descriptive (like "high" or "fast") or Numerical (numbers). And Numerical Data can be Discrete or Continuous: Discrete data is counted, Continuous data is measured.

### Discrete Data
Discrete Data can only take certain values.
the number of students in a class.
the results of rolling 2 dice

### Continuous Data
Continuous Data can take any value (within a range)
A person's height: could be any value (within the range of human heights), not just certain fixed heights.

## Numerical Variables and Categorical Variables
### Numerical Variables
A numerical or continuous variable (attribute) is one that may take on any value within a finite or infinite interval (e.g., height, weight, temperature, blood glucose, ...). There are two types of numerical variables, **interval** and **ratio**. An interval variable has values whose differences are interpretable, but it does not have a true zero. 
A good example is temperature in Centigrade degrees. Data on an interval scale can be added and subtracted but cannot be meaningfully multiplied or divided. For example, we cannot say that one day is twice as hot as another day. In contrast, a ratio variable has values with a true zero and can be added, subtracted, multiplied or divided (e.g., weight).

### Categorical Variables
A categorical or discrete variable is one that has two or more categories (values).  There are two types of categorical variable, **nominal** and **ordinal**.  A nominal variable has no intrinsic ordering to its categories. For example, gender is a categorical variable having two categories (male and female) with **no intrinsic ordering** to the categories. An ordinal variable has a **clear ordering**. For example, temperature as a variable with three orderly categories (low, medium and high).

A frequency table is a way of counting how often each category of the variable in question occurs. It may be enhanced by the addition of percentages that fall into each category.
Example: The housing variable with three categories (for free, own and rent).

![](https://i.imgur.com/SFvECMA.png)

## How to Show Data
### Univariate Analysis
We can use bar graphs to show the relative sizes of many things, such as what type of car people have, how many customers a shop has on different days and so on.

#### Histograms vs Bar Graphs
Bar Graphs are good when your data is in categories (such as "Comedy", "Drama", etc). But when you have continuous data (such as a person's height) then use a Histogram. It is best to leave gaps between the bars of a Bar Graph, so it doesn't look like a Histogram.

![](https://i.imgur.com/ksNOaKV.png)

#### Pie Chart
Pie Chart: a special chart that uses "pie slices" to show relative sizes of data
Imagine you survey your friends to find the kind of movie they like best.

![](https://i.imgur.com/pp4NwDQ.png)

#### Dot Plots
A Dot Plot is a graphical display of data using dots.

![](https://i.imgur.com/lirUgGA.png)

#### Line Graphs
a graph that shows information that is connected in some way (such as change over time).

![](https://i.imgur.com/l4bt857.png)

#### Box plot
The box-and-whiskers plot depicts the five-number summary values using the horizontal lines and dots. The horizontal lines forming the box in the middle of each gure represent Q1, Q2 (the median), and Q3 while reading the plot from the bottom to the top.

### Bivariate Analysis
Bivariate analysis is the simultaneous analysis of two variables (attributes). It explores the concept of relationship between two variables, whether there exists an association and the strength of this association, or whether there are differences between two variables and the significance of these differences. There are three types of bivariate analysis.

#### Numerical & Numerical
#### Scatter Plot
A scatter plot is a useful visual representation of the relationship between **two numerical variables (attributes)** and is usually drawn before working out a linear correlation or fitting a regression line. The resulting pattern indicates the type (linear or non-linear) and strength of the relationship between two variables. More information can be added to a two-dimensional scatter plot, for example, we might label points with a code to indicate the level of a third variable. If we are dealing with many variables in a data set, a way of presenting all possible scatter plots of two variables at a time is in a scatter plot matrix.

![](https://i.imgur.com/dCAir5m.png)

#### Linear Correlation
Linear correlation quantifies the strength of a linear relationship between **two numerical variables**. When there is no correlation between two variables, there is no tendency for the values of one quantity to increase or decrease with the values of the second quantity.

\begin{array}{ll}
r=\frac{Covar\left(x,y\right)}{\sqrt{Var\left(x\right)Var\left(y\right)}}\\
Covar\left(x,y\right)=\frac{\sum\left(x-\bar{x}\right)\left(y-\bar{y}\right)}{n} & \textrm{r:Linear Correlation}\\
Var\left(x\right)=\frac{\sum(x-\bar{x})^{2}}{n} & \textrm{Covar:Covariance}\\
Var\left(y\right)=\frac{\sum(y-\bar{y})^{2}}{n} & \textrm{Var:Variance}
\end{array}

r only measures the strength of a linear relationship and is always **between -1 and 1 where -1** means perfect negative linear correlation and +1 means perfect positive linear correlation and zero means no linear correlation.

![](https://i.imgur.com/yzIj54I.png)

There is a weak linear correlation between Temperature and Humidity.

### Categorical & Categorical
#### Stacked Column Chart
Stacked Column chart is a useful graph to visualize the relationship between **two categorical variables**. It compares the percentage that each category from one variable contributes to a total across categories of the second variable.

![](https://i.imgur.com/A0XiIQu.png)

#### Combination Chart
A combination chart uses two or more chart types to emphasize that the chart contains different kinds of information. Here, we use a bar chart to show the distribution of one categorical variable and a line chart to show the percentage of the selected category from the second categorical variable. The combination chart is the best visualization method to demonstrate the predictability power of a predictor (X-axis) against a target (Y-axis).

![](https://i.imgur.com/3kkO4Vn.gif)

#### Chi-square Test
The chi-square test can be used to determine the association between **categorical variables.** It is based on the difference between the expected frequencies (e) and the observed frequencies (n) in one or more categories in the frequency table. The chi-square distribution returns a probability for the computed chi-square and the degree of freedom. A probability of zero shows a complete dependency between two categorical variables and a probability of one means that two categorical variables are completely independent. Tchouproff Contingency Coefficient measures the amount of dependency between two categorical variables.

\begin{array}{ll}
\chi^{2}=\sum_{i=1}^{r}\sum_{j=1}^{c}\frac{\left(n_{ij}-e_{ij}\right)^{2}}{e_{ij}} & \textrm{Tchouproff Contingency Coeffieient}\\
e_{ij}=\frac{n_{i}n_{j}}{n} & \rho_{\tau}=\sqrt{\frac{\chi^{2}}{n\sqrt{\left(c-1\right)\left(r-1\right)}}}\\
df=\left(r-1\right)\left(e-1\right)
\end{array}
The following frequency table (contingency table) with a chi-square of 10.67, degree of freedom (df) of 2 and probability of 0.005 shows a significant dependency between two categorical variables (hair and eye colors).

![](https://i.imgur.com/Z3DA6lw.png)


### Categorical & Numerical
#### Line Chart with Error Bars
A line chart with error bars displays information as a series of data points connected by straight line segments. Each data point is average of the numerical data for the corresponding category of the categorical variable with error bar showing standard error. It is a way to summarize how pieces of information are related and how they vary depending on one another.

#### Combination Chart
A combination chart uses two or more chart types to emphasize that the chart contains different kinds of information. Here, we use a bar chart to show the distribution of a binned numerical variable and a line chart to show the percentage of the selected category from the categorical variable. The combination chart is the best visualization method to demonstrate the predictability power of a predictor (X-axis) against a target (Y-axis).

![](https://i.imgur.com/o6urb9M.gif)

#### Z-test and t-test
Z-test and t-test are basically the same. They assess whether the averages of two groups are statistically different from each other. This analysis is appropriate for comparing the averages of a numerical variable for two categories of a categorical variable. 
\begin{array}{ll}
 & \bar{X}_{1},\bar{X_{2}:\textrm{Averages}}\\
Z=\frac{\bar{X}_{1}-\bar{X}_{2}}{\sqrt{\frac{S_{1}^{2}}{N_{1}}+\frac{S_{2}^{2}}{N_{2}}}} & S_{1}^{2},S_{2}^{2}:\textrm{Variances}\\
 & N_{1},N_{2}:\textrm{Counts}\\
 & Z:\textrm{Standard Normal Distribution}
\end{array}

If the probability of Z is small, the difference between two averages is more significant.

t-test

When the $n_1$ or $n_2$ is less than 30 we use the t-test instead of the Z-test.
\begin{array}{ll}
 & \bar{X}_{1},\bar{X_{2}:\textrm{Averages}}\\
Z=\frac{\bar{X}_{1}-\bar{X}_{2}}{\sqrt{S^{2}\left(\frac{1}{N_{1}}+\frac{1}{N_{2}}\right)}} & S_{1}^{2},S_{2}^{2}:\textrm{Variances}\\
 & N_{1},N_{2}:\textrm{Counts}\\
S^{2}=\frac{\left(N_{1}-1\right)S_{1}^{2}+\left(N_{2}-1\right)S_{2}^{2}}{N_{1}+N_{2}-2} & t:\textrm{t Distribution}withN_{1}+N_{2}-2\textrm{degree of freedom}
\end{array}

Is there a significant difference between the means (averages) of the numerical variable (Temperature) in two different categories of the categorical variable (O-Ring Failure)?

![](https://i.imgur.com/Dy9R29o.png)

The low probability (0.0156) means that the difference between the average temperature for failed O-Ring and the average temperature for intact O-Ring is significant.

#### Analysis of Variance (ANOVA)
The ANOVA test assesses whether **the averages of more than two groups are statistically different from each other**. This analysis is appropriate for comparing the averages of a numerical variable for more than two categories of a categorical variable.

![](https://i.imgur.com/Cwnnpta.png)

\begin{array}{ll}
SS_{B}=\sum_{i=1}^{k}\frac{\left(\sum x\right)_{i}^{2}}{N_{i}}-\frac{\left(\sum_{i=1}^{k}\left(\sum x\right)_{i}\right)^{2}}{\sum_{i=1}^{k}N_{i}} & df_{W}=\sum N_{i}-k\\
SS_{W}=\sum_{i=1}^{k}\left(\sum x^{2}\right)_{i}-\sum_{i=1}^{k}\frac{\left(\sum x\right)_{i}^{2}}{N_{i}} & df_{B}=k-1\\
SS_{T}=\sum_{i=1}^{k}\left(\sum x^{2}\right)_{i}-\frac{\left(\sum_{i=1}^{k}\left(\sum x\right)_{i}\right)}{\sum_{i=1}^{k}N_{i}} & df_{T}=\sum N_{i}-1
\end{array}

$F$: has F distribution with $df_{B}$ and $df_{w}$ degree of freedom.

Is there a significant difference between the averages of the numerical variable (Humidity) in the three categories of the categorical variable (Outlook)?

![](https://i.imgur.com/RdC8PG6.png)

There is no significant difference between the averages of Humidity in the three categories of Outlook.

## Interpolation and Extrapolation
Interpolation is where we find a value inside our set of data points.

![](https://i.imgur.com/Zwi3WNn.png)

Here we use linear interpolation to estimate the sales at 21 °C.

Extrapolation is where we find a value outside our set of data points.

![](https://i.imgur.com/d7vUThQ.png)

Here we use linear extrapolation to estimate the sales at 29 °C (which is higher than any value we have).

## R Case -- ggplot2
ggplot(data=<data.frame>, aes()+ geom_

Exploring the structure of data

str() function provides a method to display the structure of R data structures such as data frames, vectors....
```{r}
getwd()  # put the usedcars.csv into working location
 usedcars <- data<-read.csv("C:/..../usedcars.csv", header=T, sep=",")
str(usedcars)
```

summary statistics
```{r}
summary(usedcars$price) # one Numerical

summary(usedcars$model) # one Categorical

summary(usedcars[c("price", "mileage")]) #  two Numerical

summary(usedcars[c("model","price")]) # two Categorical

summary(usedcars[c("model","transmission")]) # one Categorical one Numerical

```

## ggplot2 Install
```{r}
install.packages("ggplot2") # cran mirrors location - Japan
str(usecars) # the structure of R data structures
df <- data.frame(usecars) # # ggplot only accept data.frame
summary(usedcar$year) # summary statistics. 
```

### One Numerical
```{r}
c <- ggplot(usedcars, aes(mileage)); c2 <- ggplot(usedcars)

c + geom_area(stat = "bin")

c + geom_density(bins = 21) 

c + geom_dotplot()

c + geom_histogram()

c + geom_freqpoly()

c2 + geom_qq(aes(sample = mileage))
```
The histogram is composed of a series of bars with heights indicating the count, or frequency
```{r}
hist(usedcars$price, main = "Histogram of Used Car Prices",
              xlab = "Price ($)")
hist(usedcars$mileage, main = "Histogram of Used Car Mileage",
              xlab = "Odometer (mi.)")
```

### One Categorical 
```{r}
d <- ggplot(usedcars, aes(model))
d + geom_bar()
```

### Two Numerical - Scatter Plot
A scatterplot is a diagram that visualizes a bivariate relationship.
```{r}
ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_point()

ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_smooth()

ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_line()

ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_point() + geom_smooth()

ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_point() + geom_smooth(method = "lm",
              formula = y ~ x,
              se = FALSE)
```

### One Numerical One Categorical
```{r}
ggplot(data = usedcars,
   aes(x = model,y = price)) + geom_col()

ggplot(data = usedcars,
   aes(x = model,y = price)) + geom_boxplot()


ggplot(data = usedcars,
   aes(x = model,y = price)) + geom_violin()
```
box-and-whiskers plot depicts the  ve-number summary values using the horizontal lines and dots. The horizontal lines forming the box in the middle of each  gure represent Q1, Q2 (the median), and Q3.

```{r}
boxplot(usedcars$price, main="Boxplot of Used Car Prices",
                    ylab="Price ($)")
boxplot(usedcars$mileage, main="Boxplot of Used Car Mileage",
                    ylab="Odometer (mi.)")                   
```

### Two Categorical
```{r}
ggplot(data = usedcars,
   aes(x = model,y = transmission)) + geom_count()

ggplot(data = usedcars,
   aes(x = model,y = transmission)) + geom_jitter()
```

### Aesthetic attributes
#### Color
```{r}
ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_point(color = "blue")

ggplot(data = usedcars,
   aes(x = model,y = price)) + geom_col(color = "blue")

ggplot(usedcars, aes(model,color = transmission))+ geom_bar() # depend on one Categorical

ggplot(usedcars, aes(price,color = transmission))+ geom_boxplot() # depend on one Categorical

ggplot(data = usedcars) + geom_point(aes(x = mileage,y = price, color = transmission))
```
#### Position -
```{r}
ggplot(usedcars, aes(model,fill = transmission))+ geom_bar(position = "stack") # # dodge：平行排列, fill：百分比成份拆解 stack：疊上

```

#### Title + labs
```{r}
ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_point() + labs(
    x="mileage",
    y="price",
    title="usedcar",
    subtitle="unit：每加侖公里數",
    caption="資料來源"
    ) 
```
#### 轉軸 + coord_flip()
```{r}
ggplot(usedcars, aes(model,fill = transmission))+ geom_bar(position = "stack") + coord_flip()

ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_point(color = "blue")+ coord_flip()
```

#### Adding Vertical or Horizontal Lines
```{r}
ggplot(data = usedcars,
   aes(x = mileage,y = price)) + geom_point(color = "blue")+ 
   geom_vline(
    xintercept = 10,
    color = "red",
    linetype = "dashed",
    size = 1.5
  ) +
  geom_hline(yintercept = 0, color = "blue")

```

#### multiple plots
```{r}
install.packages("gridExtra")
library("gridExtra")

install.packages("gridExtra")
library("gridExtra")

p1 <- ggplot(data = usedcars,
   aes(x = model,y = price)) + geom_boxplot()

p2 <- ggplot(data = usedcars,
   aes(x = model,y = transmission)) + geom_count()

grid.arrange(p1, p2)
```

```{r}
ggplot(data = usedcars,
   aes(x = transmission,y = price)) + geom_boxplot()+
  facet_grid(~model) # depend on a categorical
  # facet_wrap(~學院,nrow=2,ncol=3)

```

# x=as.factor(讀者年級)

# others
```{r}
n <- 20
x1 <- 1:n
y1 <- rnorm(n, 0, .5)
df1 <- data.frame(x1, y1)

x2 <- (.5 * n):((1.5 * n) - 1)
y2 <- rnorm(n, 1, .5)
df2 <- data.frame(x2, y2)

ggplot() +
  geom_line(data = df1, aes(x1, y1), color = "darkblue") +
  geom_line(data = df2, aes(x2, y2), linetype = "dashed")

f <- function(x) exp(-abs(x)) * sin(2 * pi * x)
ggplot(data.frame(x = c(-3.5, 3.5))) +
  aes(x) +
  stat_function(fun = f)

```

two-way cross-tabulations
```{r}
install.packages("gmodels")
library(gmodels)

usedcars$conservative <-
       usedcars$color %in% c("Black", "Gray", "Silver", "White")
table(usedcars$conservative)
CrossTable(x = usedcars$model, y = usedcars$conservative, chisq = TRUE)

```